\documentclass[11pt]{beamer}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amssymb,amsfonts,amsmath,mathtext, mathtools}
\usepackage{cite,enumerate,float,indentfirst}
\usepackage{subcaption}

\graphicspath{{images/}}

\usetheme[usetitleprogressbar, usetotalslideindicator, nooffset]{m}

\input{names}           % Переопределение именований

\institute{\small{Институт прикладной математики и механики, СПбГПУ}}
\title{Изучение связей между оценками параметров моделей случайных процессов с помощью копул}
\author{\small{%
Выступающий ст. гр. 43601/2: \hfill ~И. П. Дмитриевский\\%
Руководитель:~доц.,~к.ф.-м.н. \hfill ~А. А. Иванков}\\%
\vfill
}
\date{\small{Санкт-Петербург, 2015}}

\begin{document}

\maketitle

\begin{frame}
\frametitle{Модель случайного процесса}
\begin{equation}
X(t) = Z(t) + Y(t)
\end{equation}
\begin{equation}
Z(t) = \mu + \sigma W(t)
\end{equation}
\begin{equation}
Y(t) = \sum_{j=0}^K P_j \cdot I(t - \tau_j) \cdot e^{-\lambda_c(t - \tau_j)}
\end{equation}
\begin{equation}
(\mu, \sigma, x_m, \alpha, \lambda, \lambda_c)
\end{equation}
\end{frame}

\begin{frame}
\frametitle{Оценивание параметров $X(t)$}
\begin{itemize}
  \item Реализован алгоритм оценивания параметров процесса (Сидоровская, 2015 г.);
  \item В рамках реализованного подхода наиболее критичный этап --- интервальное оценивание;
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Постановка задачи}
Дано:
\begin{itemize}
  \item Результаты вычислительных экспериментов по интервальному оцениванию (Сидоровская, 2015 г.);
  \item Величина набора данных $\sim 10^5$;
\end{itemize}

Требуется:
\begin{itemize}
  \item Оценить стохастические связи между результатами алгоритма интервального оценивания;
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Выбранный метод}
\begin{itemize}
  \item Различные коэффициенты корреляции дают слабое представление о структуре связи;
  \item Для более полного изучения связей требуется аппроксимировать двумерное распределение;
  \item Копулы дают исчерпывающее описание стохастической связи;
\end{itemize}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Копулы}
\begin{equation}
H(x, y) = C(F(x), G(y))
\end{equation}
\begin{itemize}
  \item Аппарат копул активно развивается;
  \item Копулы успешно применяются во многих сферах;
  \item Копулы являются гибким инструментом для исследования связей;
\end{itemize}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Аппроксимируемые распределения}
\begin{itemize}
  \item Интервальные оценки параметра $\sigma = s$ --- случайные величины $\sigma_1, \sigma_2$;
  \item Попадание $s \in [\sigma_1, \sigma_2]$ --- случайная величина $\omega_{\sigma = s} \in \{\,0,1\,\}$;
  \item Аппроксимируются вероятности $\widehat{p}_{\sigma = s} = \P\{\, \omega_{\sigma = s} = 1\,\}$ для различных пар параметров и значений;
\end{itemize}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Использовавшийся инструментарий}
\begin{itemize}
  \item Созданный программный пакет на я. п. \texttt{C++} позволяет:
    \begin{itemize}
      \item манипулировать распределениями и копулами;
      \item строить аппроксимации копул;
      \item экспортировать результаты аппроксимации в формате, совместимом с \texttt{gnuplot};
    \end{itemize}
  \item \texttt{gnuplot} --- утилита c богатым выбором выходных форматов, позволяющая визуализировать данные;
\end{itemize}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Пример визуализации копулы с меньшим $x_m$}
\resizebox{\columnwidth}{!}{\input{plots/plot_10_20_1000}}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{График изучаемой модели процесса}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Пример визуализации копулы с б\'{о}льшим $x_m$}
\resizebox{\columnwidth}{!}{\input{plots/plot_10_21_1000}}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Пример трактовки копулы}
\begin{itemize}
  \item Из-за структуры процесса известен характер связи параметров $\sigma$ и $x_m$;
  \item Чем больше вероятность правильно оценить $x_m$, тем вероятнее, $x_m$ тоже будет оценён верно;
  \item Результат аппроксимации копулы соответствует такой связи;
\end{itemize}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Результаты}
\begin{itemize}
  \item Создан программный пакет, позволяющий работать с распределениями и аппоксимировать копулы;
  \item Построено 243 графика для изучаемой модели процесса --- для каждой комбинации параметров и их значений;
  \item Известные характеристики алгоритма оценивания подтвердились:
  \begin{itemize}
    \item Графики плотностей не плоские, что соответствует наличию стохастических связей;
    \item Проявилась известная связь между оценками параметров $\sigma$ и $x_m$;
  \end{itemize}
  \item Трактовка полученных копул позволяет судить о характере различных зависимостей;
\end{itemize}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
Спасибо за внимание!
\end{center}
\end{frame}

\begin{frame}
\frametitle{Пуассоновский поток событий $Y(t)$}
\[Y(t) = \sum_{j = 0}^K P_j \cdot I(t - \tau_j) \cdot e^{-\lambda_c(t - \tau_j)}\]
\begin{itemize}
  \item $K$~---~число событий, поступивших до момента $t$;
  \item $\tau_j$~---~время возникновения $j$-ого возмущения;
  \item $I$~---~функция Хевисайда;
  \item $\lambda_c$~---~константа, одинаковая для всех событий;
  \item $P_j$~---~случайная величина, распределённая по закону Парето с параметрами $x_m$ и $\alpha$, одинаковыми для всех событий:
\[
f_{P_j}(x) = \begin{cases}
\frac{\alpha x_m^\alpha}{x^{\alpha+1} }, &x \geqslant x_m,\\
0, &x < x_m.
\end{cases}
\]
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Метод отражений}
\[\hat{c}_h(u, v) = \frac{1}{Th^2}\sum_{i=1}^T\sqts{K\brts{\frac{u - \hat{U}_i}{h}}K\brts{\frac{v - \hat{V}_i}{h}} + \cdots},\]
где места $\hat{U}_i$ и $\hat{V}_i$ занимают все отражения $(\pm\hat{U}_i, \pm\hat{V}_i), (\pm\hat{U}_i, 2 - \hat{V}_i), (2- \hat{U}_i, \pm\hat{V}_i), (2 - \hat{U}_i, 2- \hat{V}_i)$.
\end{frame}

\begin{frame}
\frametitle{Метод преобразований}
\begin{align}
\hat{c}_h(u, v) = &\frac{1}{Th^2g(G^{-1}(u))g(G^{-1}(v))}\times \\
&\sum_{i=1}^T K\brts{\frac{G^{-1}(u) - G^{-1}(\hat{U}_i)}{h},\frac{G^{-1}(v) - G^{-1}(\hat{V}_i)}{h}}
\end{align}
где $G$ --- функция распределения с положительной плотностью $g$.
\end{frame}

\begin{frame}
\frametitle{Копулы}
\emph{Двумерной копулой} называется функция $C$, удовлетворяющая следующим свойствам:
\begin{enumerate}
\item $\Dom{C} = I^2$;
\item $\forall u,v \in I : C(u, 0) = 0 = C(0, v)$;
\item $\forall B = [x_1, x_2] \times [y_1, y_2] \subset I^2 : \Diff_{y_1}^{y_2}\Diff_{x_1}^{x_2}C(x, y) \geqslant 0$;
\item Для каждых $u, v \in I$:
  \begin{gather}
    C(u, 1) = u \\
    C(1, v) = v.
  \end{gather}
\end{enumerate}
\end{frame}

\begin{frame}
\frametitle{Примеры копул}
\begin{figure}[H]
  \centering
  \begin{subfigure}{.3\textwidth}
    \centering
    \includegraphics[width=\linewidth]{W.png}
    \caption{$z = W(u, v)$}
  \end{subfigure}%
  \begin{subfigure}{.3\textwidth}
    \centering
    \includegraphics[width=\linewidth]{P.png}
    \caption{$z = P(u, v)$}
  \end{subfigure}
  \begin{subfigure}{.3\textwidth}
    \centering
    \includegraphics[width=\linewidth]{M.png}
    \caption{$z = M(u, v)$}
  \end{subfigure}
  \caption{Графики копул $W$, $P$ и $M$}
\end{figure}
\end{frame}

\begin{frame}
\frametitle{Теорема Скляра и теорема об инвариантности}
\begin{itemize}
\item Пусть $X, Y$ --- случайные величины с распределениями $F, G$ соответственно, и совместным распределением $H$. Тогда выполняется уравнение
\begin{equation}
  H(x, y) = C(F(x), G(y)).
\end{equation}
Если $F$ и $G$ непрерывны, то $C$ единственна;

\item Пусть $X, Y$ --- непрерывные случайные величины c копулой $C_{XY}$. Если $\alpha$ и $\beta$ строго возрастают на $\Ran{X}$ и $\Ran{Y}$ соответственно, то $C_{\alpha(X)\beta(Y)} = C_{XY}$. Таким образом $C_{XY}$ инвариантна относительно строго возрастающих преобразований $X$ и $Y$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Коэффициент корреляции Пирсона}
\begin{figure}\label{fig:pearson}
\centering
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width = \textwidth]{./images/normscatter.png}
  \caption{$(x, y) \sim \mathcal{N}, \rho = 0.06 $}
  \label{fig:norm}
\end{subfigure}
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width = \textwidth]{./images/transformed_normscatter.png}
  \caption{$(x, y) = (\e^x, \e^{2y}), \rho = -0.33$}
  \label{fig:transnorm}
\end{subfigure}
\end{figure}
\end{frame}

\begin{frame}
\frametitle{Коэффициент ранговой корреляции Кендалла}
\begin{itemize}
  \item \emph{Коэффициентом ранговой корреляции} вектора случайных величин $\trans{(X, Y)}$ называется величина
\begin{equation}
  \tau(X, Y) = \P\{\, (X - \widetilde{X})(Y - \widetilde{Y}) > 0 \,\} - \P\{\, (X - \widetilde{X})(Y - \widetilde{Y}) < 0 \,\},
\end{equation}
где $\trans{(\widetilde{X}, \widetilde{Y})}$ --- независимая копия $\trans{(X, Y)}$. \par

\item Пусть $X, Y$ --- непрерывные случайные величины с копулой $C$, тогда их коэффициенту Кендалла соответствует выражение
  \[
  \tau(X, Y) = \tau_C = 4 \iint_{I^2} C(u, v) \d C(u,v) - 1.
  \]
\end{itemize}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Построение эмпирических копул}
\begin{figure}[H]
  \centering
  \includegraphics[width=.56\textwidth]{FrankMirror.png}
  \caption{Графики оценённой (метод отражений, 1000 наблюдений) и истинной плотностей копулы Фрэнка}
\end{figure}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\frametitle{Построение эмпирических копул (1)}
\begin{figure}[H]
  \centering
  \includegraphics[width=.56\textwidth]{FrankTransform.png}
  \caption{Графики оценённой (метод преобразований, 1000 наблюдений) и истинной плотностей копулы Фрэнка}
\end{figure}
\end{center}
\end{frame}

\end{document}
