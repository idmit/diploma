\chapter*{Введение}							% Заголовок
\addcontentsline{toc}{chapter}{Введение}	% Добавляем его в оглавление

Необходимость изучения систем, которые случайным образом изменяются с течением времени, постоянно растёт. Математическая модель для описания таких систем основана на понятии стохастического процесса.

\section*{Объекты и предмет исследования}
\subsection*{Случайные процессы}

\emph{Стохастический (случайный) процесс} рассматривается как множество $\{\, X(t) \mid t \in T \,\}$ случайных величин $X(t)$, определённых на одном вероятностном пространстве, где $T \subset \R$. $T$ может интерпретироваться как время.
\begin{define}
	Случайный процесс называется \emph{дискретным во времени}, если $T \subset \Z$.
\end{define}
\begin{define}
 	Если все случайные величины $X(t)$ принимают значения из фиксированного множества $\J$, то $\J$ называется \emph{пространством состояний} процесса.
\end{define}
Для каждого $t \in T$ функция распределения $X_t$ обозначается $F_t$.
\begin{define}
	Процесс $\{\, X(t) \mid t \in T \,\}$ называется \emph{марковским}, если для каждого конечного подмножества $\{\, t_1, t_2, \ldots, t_n \,\} \subset T$ и $\forall t \in T$ таких, что $t_1 < t_2 < \cdots < t_n < t$, справедливо
\[
\P\{X_t \leqslant x \mid X_{t_1} = x_1, X_{t_2} = x_2, \ldots, X_{t_n} = x_n\} = \P\{X_t \leqslant x \mid X_{t_n} = x_n\}.
\]
\end{define}

\subsection*{Стохастические связи между случайными процессами}

\subsection*{Входные данные и цель работы}

\section*{Существующие оценки стохастических связей}
\subsection*{Коэффициент корреляции}

\begin{define}
Линейным коэффициентом корреляции вектора случайных величин $\trans{(X, Y)}$ с ненулевыми конечными дисперсиями называется величина
\begin{equation}
	\rho(X, Y) = \frac{\cov(X, Y)}{\sqrt{\D(X)\D(Y)}},
\end{equation}
где $\cov(X, Y) = \E(XY) - \E(X)\E(Y)$ --- ковариация $\trans{(X, Y)}$, а $\D(X)$ и $\D(Y)$ --- соответствующие дисперсии.
\end{define}

Если имеются выборки $\{x_i\}_{i=1}^n, \{y_i\}_{i=1}^n$ значений случайных величин $X, Y$, то линейный коэффициент корреляции можно оценить величиной
\begin{equation}
r_{X, Y} = \frac{\sum_{i=1}^{n} (x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \overline{x})^2 \sum_{i=1}^{n} (y_i - \overline{y})^2}}.
\end{equation}

Величины $\rho(X, Y)$, $r_{X, Y}$ инвариантны относительно строго возрастающих линейных преобразований $X, Y$, то есть
\[
\forall a > 0, c > 0, b, d \in \R \colon \rho(X, Y) = \rho(aX + b, cY + d).
\]

\subsubsection*{Необходимые условия применения}
Для вычисления $\rho(X, Y)$ должны существовать ковариация и конечные ненулевые дисперсии величин $X, Y$. При вычислении $r_{X, Y}$ необходимо учитывать, что это не робастная статистика, и убедиться, что выборки не содержат выбросов.
\subsubsection*{Семантика оценки}
Из определения ясно, что $\rho(X, Y) \in [-1, 1]$. Так как это мера линейной зависимости, то выполняется
\[
Y = aX + b, a \neq 0, b \in \R \iff |\rho(X, Y)| = 1.
\]

Если $|\rho(X, Y)| < 1$, то положительный $\rho(X, Y)$ показывает, что значения $X$ и $Y$ имеют тенденцию быть одновременно больше или одновременно меньше соответствующих им средних. Отрицательный --- что значения $X$ и $Y$ имеют тенденцию лежать по разные стороны от соответствующих им средних.

\subsection*{Оценка $\tau$ Кендалла}

\begin{define}
Коэффициентом ранговой корреляции вектора случайных величин $\trans{(X, Y)}$ называется величина
\begin{equation}
	\tau(X, Y) = \P\{(X - \widetilde{X})(Y - \widetilde{Y}) > 0\} - \P\{(X - \widetilde{X})(Y - \widetilde{Y}) < 0\},
\end{equation}
где $\trans{(\widetilde{X}, \widetilde{Y})}$ --- независимая копия $\trans{(X, Y)}$.
\end{define}

Если имеются выборки $\{x_i\}_{i=1}^n, \{y_i\}_{i=1}^n$ значений случайных величин $X, Y$, то пары $(x_i, y_i), (x_j, y_j)$, образуемые соответствующими значениями из этих выборок, называются
\begin{itemize}
	\item согласованными, если $(x_i > x_j \text{ и } y_i > y_j) \text{ или } (x_i < x_j \text{ и } y_i < y_j)$;
	\item несогласованными, если $(x_i < x_j \text{ и } y_i > y_j) \text{ или } (x_i > x_j \text{ и } y_i < y_j)$;
\end{itemize}
Если $x_i = x_j \text{ или } y_i = y_j$, то такая пара не классифицируется. Таким образом, коэффициент ранговой корреляции можно оценить величиной
\begin{equation}
\tau_{X, Y} = \frac{(\text{число согласованных пар}) - (\text{число несогласованных пар})}{\frac{1}{2}n(n - 1)}.
\end{equation}

\subsubsection*{Необходимые условия применения}
В отличие от линейного коэффициента корреляции коэффициент $\tau$ намного меньше подвержен влиянию выбросов, находящихся в выборке.
\subsubsection*{Семантика оценки}
Из определения ясно, что $\tau_{X, Y} \in [-1, 1]$. Если все пары согласованы, то оценка принимает значение $1$. Если все пары несогласованы, то значение равно $-1$. В случае, когда $X$ и $Y$ независимы, можно ожидать, что оценка будет примерно равна нулю.

Положительный $\tau_{X, Y}$ показывает, что большее количество пар согласовано, а отрицательный~--- что большее количество пар несогласовано.

\subsection*{Оценка с использованием копул}

\subsubsection*{Копулы}
Копула (от лат. copula --- связка) это многомерная функция распределения, определённая на $n$-мерном единичном кубе $[0, 1]^n$, такая, что маргинальное распределение каждой компоненты равномерно на интервале $[0, 1]$. Копулы используются для описания зависимости между случайными величинами.

\begin{define}
Пусть имеется случайный вектор $(X_1, X_2, \ldots, X_d)$. Пусть функции $F_i(x) = \P\{X_i \leq x\}$ непрерывны $\forall i = \overline{1, d}$. Тогда компоненты случайного вектора
\begin{equation}
(U_1, U_2, \ldots, U_d)= (F_1(X_1),F_2(X_2), \ldots, F_d(X_d))
\end{equation}
будут иметь равномерное распределение $\forall i = \overline{1, d}$.

Копулой вектора $(X_1, X_2, \ldots, X_d)$ называется совместная функция распределения $(U_1, U_2, \ldots, U_d)$:
\begin{equation}
C(u_1, u_2, \ldots, u_d)=\P\{U_1 \leq u_1, U_2 \leq u_2, \dots, U_d \leq u_d\}.
\end{equation}
\end{define}
Копула $C$ содержит в себе информацию о структуре зависимости между компонентами вектора $(X_1, X_2, \ldots, X_d)$, а маргинальные распределения $F_i$ в свою очередь содержат информацию о распределениях отдельных компонент $\forall i = \overline{1, d}$. Учитывая непрерывность $F_i, i = \overline{1, d}$, копулу $C$ можно записать в виде:
\begin{equation}
C(u_1, u_2, \ldots, u_d)=\P\{X_1 \leq F_1^{-1}(u_1), X_2 \leq F_2^{-1}(u_2), \ldots, X_d \leq F_d^{-1}(u_d)\}.
\end{equation}

Если имеется выборка $\{(X_1^i, X_2^i,\ldots, X_d^i)\}_{i=1}^n $ значений случайного вектора $(X_1, X_2, \ldots, X_d)$ с непрерывными маргиналами, то эти маргиналы оцениваются эмпирически:
\begin{equation}
	F_k^n(x) = \frac{1}{n} \sum_{i = 1}^n \mathbf{1}(X_k^i \leq x).
\end{equation}
В таком случае выборка значений копулы оценивается
\begin{equation}
	(\widetilde{U}_1^i, \widetilde{U}_2^i, \ldots, \widetilde{U}_d^i)=(F_1^n(X_1^i),F_2^n(X_2^i),\dots,F_d^n(X_d^i)), \, i = \overline{1, n}.
\end{equation}
Соответствующая эмпирическая копула задаётся выражением
\begin{equation}
	C^n(u_1, \ldots, u_d) = \frac{1}{n} \sum_{i = 1}^n \mathbf{1}(\widetilde{U}_1^i \leq u_1, \ldots, \widetilde{U}_d^i \leq u_d).
\end{equation}

\subsubsection*{Необходимые условия применения}
Одним из следствий теоремы Скляра является утверждение, что для любой многомерной функции распределения
\begin{equation}
	H(x_1, \ldots, x_d) = \P\{X_1 \leq x_1, \ldots, X_d \leq x_d\}
\end{equation}
случайного вектора $(X_1, X_2, \ldots, X_d)$ с непрерывными маргинальными распределениями $F_i(x), i \in~\overline{1, d}$ существует единственная копула $C$ такая, что
\begin{equation}
	H(x_1, \ldots, x_d) = C(F_1(x_1), \ldots, F_d(x_d)).
\end{equation}

Верно и обратное: копула $C: [0, 1]^d \rightarrow [0, 1]$ и функции распределения $F_i(x), i = \overline{1, d}$ определяют $d$-мерную функцию $C(F_1(x_1), \ldots, F_d(x_d))$, которая является двумерной функцией распределения с маргиналами $F_i(x), i = \overline{1, d}$.
\subsubsection*{Семантика оценки}
Для любой копулы $C: [0, 1]^d \rightarrow [0, 1]$ и любых $(u_1, \ldots, u_d) \in [0, 1]^d$ выполняется:
\begin{equation}
	W(u_1, \ldots, u_d) \leq C(u_1, \ldots, u_d) \leq M(u_1, \ldots, u_d).
\end{equation}
Функции $W$ и $M$ называются нижней и верхней границами Фреше соответственно и определяются как
\begin{align}
	W(u_1, \ldots, u_d) &= \max\left\{1 - d + \sum_{i = 1}^d {u_i} , 0 \right\} \\
	M(u_1, \ldots, u_d) &= \min \{u_1, \dots, u_d\}.
\end{align}

Довольно легко получить \cite{Nelsen1999}, что функция $\tau(C)$, задаваемая выражением
\begin{equation}
	\tau(C) = 4\E(C) - 1,
\end{equation}
совпадает с коэффициентом Кендалла $\tau(X, Y)$, где $C$ --- копула, соответствующая совместному распределению $X$ и $Y$.

Два двумерных распределения, с совпадающими копулами, могут иметь разный линейный коэффициент корреляции. Это означает, что $\rho$ не может быть выражен через копулу.

\subsection*{Сравнение оценок в приложении к случайным процессам}

\section*{Программные пакеты для работы с оценками стохастических связей}
Большинство программных пакетов, имеющих отношение к статистике, имеют необходимую для работы с коэффициентами корреляции функциональность. Однако, если требуется работать с копулами, то количество подходящих пакетов сужается до двух: MATLAB и R.

\subsection*{MATLAB}
Пакет MATLAB содержит следующие функции для работы с копулами:
\begin{itemize}
	\item \texttt{copulacdf(\ldots)} --- строит функцию распределния копулы;
	\item \texttt{copulapdf(\ldots)} --- строит плотность распределения копулы;
	\item \texttt{copulaparam(\ldots)} --- возвращает параметр копулы, соответствующий ранговой корреляции;
	\item \texttt{copulastat(\ldots)} --- вычисляет коэффициент ранговой корреляции;
	\item \texttt{copulafit(\ldots)} --- оценивает копулу, исходя из входных данных;
	\item \texttt{copularnd(\ldots)} --- генерирует данные, обладающие заданными характеристиками.
\end{itemize}

\subsection*{R}
Для пакета R существует модуль \texttt{copula}(\texttt{nacopula}), имеющий обширные возможности \cite{Rcopula} по работе с копулами.

\subsection*{Ограничения и недостатки существующих программных пакетов}

\clearpage
